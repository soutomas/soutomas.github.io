<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Portfolio – Tomás Sou</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-08799928d293638fe9563d5c5a2794e5.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = true;
    const darkModeDefault = authorPrefersDark;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Tomás Sou</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./resume.html" aria-current="page"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/soutomas"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/tomas_sou"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tomás-sou" id="toc-tomás-sou" class="nav-link active" data-scroll-target="#tomás-sou">Tomás Sou</a></li>
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose">Purpose</a></li>
  <li><a href="#expertise" id="toc-expertise" class="nav-link" data-scroll-target="#expertise">Expertise</a>
  <ul class="collapse">
  <li><a href="#quantitative-medicine" id="toc-quantitative-medicine" class="nav-link" data-scroll-target="#quantitative-medicine">Quantitative Medicine</a></li>
  <li><a href="#drug-delivery" id="toc-drug-delivery" class="nav-link" data-scroll-target="#drug-delivery">Drug Delivery</a></li>
  </ul></li>
  <li><a href="#highlights" id="toc-highlights" class="nav-link" data-scroll-target="#highlights">Highlights</a>
  <ul class="collapse">
  <li><a href="#oncology-haematology" id="toc-oncology-haematology" class="nav-link" data-scroll-target="#oncology-haematology">Oncology / Haematology</a></li>
  <li><a href="#neuroscience" id="toc-neuroscience" class="nav-link" data-scroll-target="#neuroscience">Neuroscience</a></li>
  <li><a href="#nanobody" id="toc-nanobody" class="nav-link" data-scroll-target="#nanobody">Nanobody®</a></li>
  <li><a href="#global-health" id="toc-global-health" class="nav-link" data-scroll-target="#global-health">Global health</a></li>
  <li><a href="#antimicrobials-enable" id="toc-antimicrobials-enable" class="nav-link" data-scroll-target="#antimicrobials-enable">Antimicrobials / ENABLE</a></li>
  <li><a href="#antimicrobials-jpiamr" id="toc-antimicrobials-jpiamr" class="nav-link" data-scroll-target="#antimicrobials-jpiamr">Antimicrobials / JPIAMR</a></li>
  <li><a href="#inhalation-vaccines" id="toc-inhalation-vaccines" class="nav-link" data-scroll-target="#inhalation-vaccines">Inhalation &amp; Vaccines</a></li>
  <li><a href="#medication-management" id="toc-medication-management" class="nav-link" data-scroll-target="#medication-management">Medication Management</a></li>
  <li><a href="#united-nations-volunteers" id="toc-united-nations-volunteers" class="nav-link" data-scroll-target="#united-nations-volunteers">United Nations Volunteers</a></li>
  </ul></li>
  <li><a href="#publications" id="toc-publications" class="nav-link" data-scroll-target="#publications">Publications</a>
  <ul class="collapse">
  <li><a href="#software" id="toc-software" class="nav-link" data-scroll-target="#software">Software</a></li>
  <li><a href="#patents" id="toc-patents" class="nav-link" data-scroll-target="#patents">Patents</a></li>
  <li><a href="#articles" id="toc-articles" class="nav-link" data-scroll-target="#articles">Articles</a></li>
  <li><a href="#presentations" id="toc-presentations" class="nav-link" data-scroll-target="#presentations">Presentations</a></li>
  <li><a href="#posters" id="toc-posters" class="nav-link" data-scroll-target="#posters">Posters</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Portfolio</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><img src="images/TS_PSWC_2017_edited.jpg" class="img-fluid"></p>
<section id="tomás-sou" class="level1">
<h1>Tomás Sou</h1>
<p>PhD BPharm(Hons)</p>
<p>Pharmacist. Researcher. Scientist.<br>
Drug R&amp;D. Quantitative Medicine. Global Health.</p>
<p>Pharmacometrics. Drug Delivery. Inhalation. Biologics.<br>
Antimicrobials. Vaccines. Oncology. Neuroscience.</p>
<p>Senior Principal Scientist Pharmacometrics – Novartis<br>
Editorial Advisory Board Member / Top Reviewer – JPharmSci<br>
Researcher – UN Volunteers, United Nations Development Programme</p>
<hr>
</section>
<section id="purpose" class="level1">
<h1>Purpose</h1>
<p>The development of innovative medicines is a long and costly endeavour. With the ongoing advancement of technology, I believe data analytics with modelling and simulation will play an increasingly important role in modern drug discovery and development.</p>
<p>For 10+ years in clinical practice and pharmaceutical R&amp;D in multinational corporations and consortia, I have developed multidisciplinary expertise throughout the drug development process in global cross-functional project teams.</p>
<p>The interest of my work revolves around the synergistic application of data analytics and drug delivery science in predictive pharmacology and quantitative medicine, to support data-driven decisions in pharmaceutical R&amp;D and the optimal use of medicines.</p>
<p>Ultimately, I hope to bring more effective and safer treatments to patients more efficiently, with better medicines by design.</p>
</section>
<section id="expertise" class="level1">
<h1>Expertise</h1>
<section id="quantitative-medicine" class="level2">
<h2 class="anchored" data-anchor-id="quantitative-medicine">Quantitative Medicine</h2>
<ul>
<li>Pharmacometrics<br>
</li>
<li>Model-informed drug discovery and development<br>
</li>
<li>Preclinical, translational and population PK/PD modelling<br>
</li>
<li>Human dose prediction for clinical translation<br>
</li>
<li>Dose optimisation for clinical therapies<br>
</li>
<li>Small molecules and biologics</li>
</ul>
</section>
<section id="drug-delivery" class="level2">
<h2 class="anchored" data-anchor-id="drug-delivery">Drug Delivery</h2>
<ul>
<li>Inhaled formulations<br>
</li>
<li>Pulmonary drug delivery<br>
</li>
<li>Physicochemical characterisation<br>
</li>
<li>Spray-drying and particle engineering<br>
</li>
<li>Particle size and aerosolisation<br>
</li>
<li>Biologics delivery via inhalation</li>
</ul>
<hr>
</section>
</section>
<section id="highlights" class="level1">
<h1>Highlights</h1>
<section id="oncology-haematology" class="level2">
<h2 class="anchored" data-anchor-id="oncology-haematology">Oncology / Haematology</h2>
<p>Blood cancers such as acute myeloid leukemia (AML) and myelodysplastic syndromes (MDS) are characterised by dysfunctional immune system and leukaemic stem cell proliferation.</p>
<p>In oncology, thrombocytopenia is a commonly reported dose-limiting toxicity. In one project, I contributed to understanding of intertwining effects of drug and disease on platelet dynamics in haematological malignancies to support dosing decisions in cancer patients.</p>
</section>
<section id="neuroscience" class="level2">
<h2 class="anchored" data-anchor-id="neuroscience">Neuroscience</h2>
<p>Multiple sclerosis (MS) is a chronic inflammatory disease of the central nervous system. In MS, patients experience a wide range of life-limiting symptoms, ranging from problems with vision, movement and sensation to fatigue, pain and issues with memory and thinking.</p>
<p>In neuroscience, I support the clinical development and registration of new generation disease-modifying therapies for MS and other neurological conditions, for the development of small-molecules and biologics.</p>
<p>In one project, I supported evaluating the use of continuous-time Markov models as a means for fitting disease progression models in MS using the NO.MS dataset, which is the largest clinical trial dataset for MS complied by Novartis and Oxford, containing data from approximately 35,000 patients spanning all MS phenotypes and including up to 15 years of follow-up.</p>
</section>
<section id="nanobody" class="level2">
<h2 class="anchored" data-anchor-id="nanobody">Nanobody®</h2>
<p>Nanobody molecules belong to a new class of biologics that are derived from heavy-chain-only peptides and are around a tenth the size of conventional antibodies.</p>
<p>In Sanofi, as a clinical pharmacometrician in development project teams, I contributed to the population PK/PD modelling and simulation activities for the development of both small molecules and biologics in clinical studies (FIH to Ph3), including first-in-human evaluation, proof-of-concept study design, international submission, labelling extension, paediatrics extrapolation and alternative dosing regimen exploration.</p>
<p>In one project, I was involved in preparing the submission package to PMDA in Japan for extending the use of caplacizumab to paediatric patients in the Japanese population. Due to the indication being a rare disease, dose extrapolation using a modelling approach, without any clinical data in paediatric patients, was used to support this submission.</p>
</section>
<section id="global-health" class="level2">
<h2 class="anchored" data-anchor-id="global-health">Global health</h2>
<p>Every year nearly 300,000 women die due to pregnancy-related causes, with the risk of a woman in a developing country dying from a maternal-related cause during her lifetime around 23 times higher than a woman living in a developed country.</p>
<p>In GSK, as a formulation scientist and a project liaison, I successfully helped establish and secure the industrial-academic partnership between GSK and Monash, for the joint development of a novel inhaled formulation for maternal health in developing countries.</p>
<p>Specifically, as an inventor of the patent, I led the technical transfer and product translation in the development of a novel inhaled formulation for pulmonary delivery of biologics and supported its development feasibility study, which eventually resulted in a co-development and licensing agreement.</p>
</section>
<section id="antimicrobials-enable" class="level2">
<h2 class="anchored" data-anchor-id="antimicrobials-enable">Antimicrobials / ENABLE</h2>
<p>The European Gram-negative Antibacterial Engine (ENABLE) is a consortium under the Innovative Medicines Initiatives (IMI) funded by the EU. It is a public-private partnership for the development of new treatments with industry partners to combat antimicrobial resistance.</p>
<p>In this consortium, I represented the pharmacometrics function from Uppsala University in cross-functional project teams to support the development of new antimicrobials for industry partners. Specifically, I contributed to the PK/PD modelling and simulation activities in industrial projects, including preclinical and translational PK and PK/PD modelling of apramycin for human dose prediction and clinical translation.</p>
<p>Uppsala University is home to world-leading research groups in pharmacometrics and predictive PKPD.</p>
</section>
<section id="antimicrobials-jpiamr" class="level2">
<h2 class="anchored" data-anchor-id="antimicrobials-jpiamr">Antimicrobials / JPIAMR</h2>
<p>The Joint Programming Initiative on Antimicrobial Resistance (JPIAMR) is an EU supported initiative to combat antimicrobial resistance. I was part of the SENBIOTAR consortium funded by the programme, representing the ADME/DMPK and the drug delivery functions from Uppsala University in the global cross-functional project team.</p>
<p>In this consortium, I contributed to the screening and optimisation of novel compounds in search of candidates for early development. Specifically, I supported activities in compound characterisation and early formulation development, led and coordinated internal and external in vitro and in vivo studies for preclinical ADME/DMPK evaluation and performed preclinical PK/PD modelling to support drug candidate selection.</p>
<p>Uppsala University is home to UDOPP, a pharmaceutical and ADMET platform that provides support in drug discovery and early drug development projects.</p>
</section>
<section id="inhalation-vaccines" class="level2">
<h2 class="anchored" data-anchor-id="inhalation-vaccines">Inhalation &amp; Vaccines</h2>
<p>The unique physiology and high absorptive capacity of the lung, physiologically designed for rapid gaseous exchange, provide a potential entry route for compounds that cannot be absorbed via the gastrointestinal tract.</p>
<p>In Monash University, I was a research scientist investigating the development of dry powder formulations suitable for systemic delivery of biotherapeutics such as peptides and vaccines via inhalation.</p>
<p>Monash University was recognised as number #1 in the world in the 2022 QS World University Rankings by Subject for Pharmacy and Pharmacology.</p>
</section>
<section id="medication-management" class="level2">
<h2 class="anchored" data-anchor-id="medication-management">Medication Management</h2>
<p>In Australia, consultant pharmacists ensure their patients’ medications are appropriate, effective, as safe as possible and used correctly. We identify, resolve, and prevent medication-related problems that may interfere with the goals of therapy.</p>
<p>The Australian Association of Consultant Pharmacy (AACP) and, since 2023, the Pharmaceutical Society of Australia (PSA) are the major credentialing bodies responsible for the accreditation of consultant pharmacists. They promote and seek recognition for the practice of consultant pharmacy and the provision of value-added, professional services in Australia.</p>
<p>For over 10 years as a consultant pharmacist accredited by the AACP, I have served the Australian community and provided clinical services to patients and medical practitioners to promote the optimal use of medicines.</p>
</section>
<section id="united-nations-volunteers" class="level2">
<h2 class="anchored" data-anchor-id="united-nations-volunteers">United Nations Volunteers</h2>
<p>The United Nations Volunteers (UNV) programme is a United Nations organisation that contributes to peace and development through volunteerism worldwide.</p>
<p>In the UNV programme, I supported research on the political economy of health issues for the United Nations Development Programme (UNDP).</p>
</section>
</section>
<section id="publications" class="level1">
<h1>Publications</h1>
<p>Citations: 905+; h-index: 14</p>
<section id="software" class="level2">
<h2 class="anchored" data-anchor-id="software">Software</h2>
<ul>
<li><p>Sou T (2025). edar: Convenient Functions for Exploratory Data Analysis. R package version 0.0.5.9000, <a href="https://soutomas.github.io/edar/dev/" class="uri">https://soutomas.github.io/edar/dev/</a>.</p></li>
<li><p>Sou T (2025). RappPKPLT: Shiny Application for a PK-Platelet-GDF15 Model. R package version 0.0.0.9000, <a href="https://github.com/soutomas/RappPKPLT" class="uri">https://github.com/soutomas/RappPKPLT</a>.</p></li>
</ul>
</section>
<section id="patents" class="level2">
<h2 class="anchored" data-anchor-id="patents">Patents</h2>
<p>Patents granted in 10+ countries: AU, EU, US, CA, CN, MX, ID, ZA, BR, IN</p>
<p>Michelle McIntosh, David A Morton, Tomás Sou, Livesey Olerile, Richard Prankerd. Method and formulation for inhalation. WO2013016754A1.</p>
<ul>
<li>AU: 2011374218<br>
</li>
<li>EU: 2739268<br>
</li>
<li>US: 11065297<br>
</li>
<li>CA: 2879317<br>
</li>
<li>CN: ZL2011800739376<br>
</li>
<li>ID: IDP000048237<br>
</li>
<li>MX: 355833<br>
</li>
<li>ZA: 2014/01526<br>
</li>
<li>BR: BR112014002646-7<br>
</li>
<li>IN: 391369</li>
</ul>
</section>
<section id="articles" class="level2">
<h2 class="anchored" data-anchor-id="articles">Articles</h2>
<ul>
<li><p>Soukarieh F, Mashabi A, Richardson W, Oton EV, Romero M, Dubern JF, Robertson SN, Lucanto S, Markham-Lee Z, Sou T, et al.&nbsp;Design, synthesis, and evaluation of new 1 H-benzo[d]imidazole based PqsR inhibitors as adjuvant therapy for Pseudomonas aeruginosa Infections. J Med Chem. 2024;67(2):1008-1023. DOI: <a href="https://doi.org/10.1021/acs.jmedchem.3c00973" class="uri">https://doi.org/10.1021/acs.jmedchem.3c00973</a>.</p></li>
<li><p>Gkoufa A, Sou T, Karaiskos I, Routsi C, Lin YW, Psichogiou M, et al.&nbsp;Pulmonary and systemic pharmacokinetics of colistin methanesulfonate (CMS) and formed colistin following nebulization of CMS among patients with ventilator-associated pneumonia. Int J Antimicrob Agents. 2022;59(6):106588. DOI: <a href="https://doi.org/10.1016/j.ijantimicag.2022.106588" class="uri">https://doi.org/10.1016/j.ijantimicag.2022.106588</a>.</p></li>
<li><p>Sou T, Hansen J, Liepinsh E, Backlund M, Ercan O, Grinberga S, et al.&nbsp;Model-informed drug development for antimicrobials: Translational PK and PK/PD modeling to predict an efficacious human dose for apramycin. Clin Pharmacol Ther. 2021;109(4):1063-1073. DOI: <a href="https://doi.org/10.1002/cpt.2104" class="uri">https://doi.org/10.1002/cpt.2104</a>.</p></li>
<li><p>Sou T, Bergström CAS. Contemporary formulation development for inhaled pharmaceuticals. J Pharm Sci. 2021;110(1):66-86. DOI: <a href="https://doi.org/10.1016/j.xphs.2020.09.006" class="uri">https://doi.org/10.1016/j.xphs.2020.09.006</a>.</p></li>
<li><p>Soukarieh F, Mashabi A, Richardson W, Oton EV, Romero M, Roberston SN, Grossman S, Sou T, et al.&nbsp;Design and Evaluation of New Quinazolin-4(3H)-one Derived PqsR Antagonists as Quorum Sensing Quenchers in Pseudomonas aeruginosa. ACS Infect Dis. 2021;7(9):2666-2685. DOI: <a href="https://doi.org/10.1021/acsinfecdis.1c00175" class="uri">https://doi.org/10.1021/acsinfecdis.1c00175</a>.</p></li>
<li><p>Sou T, Soukarieh F, Williams P, Stocks MJ, Cámara M, Bergström CAS. Model-informed drug discovery and development in pulmonary delivery: Biopharmaceutical pharmacometric modeling for formulation evaluation of pulmonary suspensions. ACS Omega. 2020;5(40):25733-46. DOI: <a href="https://doi.org/10.1021/acsomega.0c03004" class="uri">https://doi.org/10.1021/acsomega.0c03004</a>.</p></li>
<li><p>Sou T, Kukavica-Ibrulj I, Levesque RC, Friberg FE and Bergström CAS. Model-informed drug development in pulmonary delivery: Semimechanistic pharmacokinetic-pharmacodynamic modeling for evaluation of treatments against chronic Pseudomonas aeruginosa lung infections. Mol Pharm. 2020;17(5):1458-1469. DOI: <a href="https://doi.org/10.1021/acs.molpharmaceut.9b00968" class="uri">https://doi.org/10.1021/acs.molpharmaceut.9b00968</a>.</p></li>
<li><p>Bue M, Sou T, Okkels ASL, Hanberg P, Thorsted A, Friberg FE, et al.&nbsp;Population pharmacokinetics of piperacillin in plasma and subcutaneous tissue in patients on continuous renal replacement therapy. Int J Infect Dis. 2020;92:133-40. DOI: <a href="https://doi.org/10.1016/j.ijid.2020.01.010" class="uri">https://doi.org/10.1016/j.ijid.2020.01.010</a>.</p></li>
<li><p>Soukarieh F, Liu R, Romero M, Roberston SN, Richardson W, Lucanto S, Oton EV, Qudus NR, Mashabi A, Grosmann S, Ali S, Sou T, et al.&nbsp;Hit identification of new potent PqsR antagonists as inhibitors of quorum sensing in planktonic and biofilm grown Pseudomonas aeruginosa. Front Chem. 2020;8(204). DOI: <a href="https://doi.org/10.3389/fchem.2020.00204" class="uri">https://doi.org/10.3389/fchem.2020.00204</a>.</p></li>
<li><p>Sou T, Kukavica-Ibrulj I, Soukarieh F, Halliday N, Levesque RC, Williams P, et al.&nbsp;Model-based drug development in pulmonary delivery: Pharmacokinetic analysis of novel drug candidates for treatment of Pseudomonas aeruginosa lung infection. J Pharm Sci. 2019;108(1):630-640. DOI: <a href="https://doi.org/10.1016/j.xphs.2018.09.017" class="uri">https://doi.org/10.1016/j.xphs.2018.09.017</a>.</p></li>
<li><p>Sou T, Bergström CAS. Automated assays for thermodynamic (equilibrium) solubility determination. Drug Discov Today Technol. 2018;27:11-9. DOI: <a href="https://doi.org/10.1016/j.ddtec.2018.04.004" class="uri">https://doi.org/10.1016/j.ddtec.2018.04.004</a>.</p></li>
<li><p>Sou T, Forbes RT, Gray J, Prankerd RJ, Kaminskas LM, McIntosh MP, et al.&nbsp;Designing a multi-component spray-dried formulation platform for pulmonary delivery of biopharmaceuticals: The use of polyol, disaccharide, polysaccharide and synthetic polymer to modify solid-state properties for glassy stabilisation. Powder Technology. 2016;287:248-55. DOI: <a href="https://doi.org/10.1016/j.powtec.2015.10.008" class="uri">https://doi.org/10.1016/j.powtec.2015.10.008</a>.</p></li>
<li><p>Sou T, Morton DAV, Williamson M, Meeusen EN, Kaminskas LM, McIntosh MP. Spray-dried influenza antigen with trehalose and leucine produces an aerosolizable powder vaccine formulation that induces strong systemic and mucosal immunity after pulmonary administration. J Aerosol Med Pulm Drug Deliv. 2015;28(5):361-71. DOI: <a href="https://doi.org/10.1089/jamp.2014.1176" class="uri">https://doi.org/10.1089/jamp.2014.1176</a>.</p></li>
<li><p>Sou T, McIntosh MP, Kaminskas LM, Prankerd RJ, Morton DAV. Designing a multicomponent spray-dried formulation platform for pulmonary delivery of biomacromolecules: The effect of polymers on the formation of an amorphous matrix for glassy state stabilization of biomacromolecules. Drying Technology. 2013;31(13-14):1451-8. DOI: <a href="https://doi.org/10.1080/07373937.2013.788019" class="uri">https://doi.org/10.1080/07373937.2013.788019</a>.</p></li>
<li><p>Sou T, Kaminskas LM, Nguyen TH, Carlberg R, McIntosh MP, Morton DAV. The effect of amino acid excipients on morphology and solid-state properties of multi-component spray-dried formulations for pulmonary delivery of biomacromolecules. Eur J Pharm Biopharm. 2013;83(2):234-43. DOI: <a href="https://doi.org/10.1016/j.ejpb.2012.10.015" class="uri">https://doi.org/10.1016/j.ejpb.2012.10.015</a>.</p></li>
<li><p>Sou T, Orlando L, McIntosh MP, Kaminskas LM, Morton DAV. Investigating the interactions of amino acid components on a mannitol-based spray-dried powder formulation for pulmonary delivery: A design of experiment approach. Int J Pharm. 2011;421(2):220-9. DOI: <a href="https://doi.org/10.1016/j.ijpharm.2011.09.018" class="uri">https://doi.org/10.1016/j.ijpharm.2011.09.018</a>.</p></li>
<li><p>Sou T, Meeusen EN, de Veer M, Morton DAV, Kaminskas LM, McIntosh MP. New developments in dry powder pulmonary vaccine delivery. Trends Biotechnol. 2011;29(4):191-8. DOI: <a href="https://doi.org/10.1016/j.tibtech.2010.12.009" class="uri">https://doi.org/10.1016/j.tibtech.2010.12.009</a>. (Journal cover)</p></li>
</ul>
</section>
<section id="presentations" class="level2">
<h2 class="anchored" data-anchor-id="presentations">Presentations</h2>
<ul>
<li><p>Sou T, Liepins E, Hansen J, Grinberga S, Backlund M, Ercan O, et al.&nbsp;“Translational PK and PKPD modelling of preclinical in-vitro and in-vivo studies to predict the efficacious human dose of apramycin”. ECCMID, Amsterdam, Netherlands. Apr 2019. (Selected for oral presentation with travel grant award)</p></li>
<li><p>Sou T. “New generation antimicrobials for the treatment of Pseudomonas aeruginosa”. 8th Symposium on Pharmaceutical Profiling in Drug Discovery and Development, Uppsala University, Uppsala, Sweden. 25 Jan 2018. (Invited speaker)</p></li>
<li><p>Sou T, Kukavica-Ibrulj I, Soukarieh F, Halliday N, Levesque RC, Williams P, et al.&nbsp;“Quorum sensing inhibitors for pulmonary delivery as a novel treatment strategy against Pseudomonas aeruginosa”. 6th FIP Pharmaceutical Sciences World Congress, Stockholm, Sweden. 21-24 May 2017. (Selected for oral presentation)</p></li>
<li><p>Sou T, Kukavica-Ibrulj I, Soukarieh F, Halliday N, Levesque RC, Williams P, et al.&nbsp;“Quorum sensing inhibitors for pulmonary delivery as a novel treatment strategy against Pseudomonas aeruginosa”. Northern Pharma Network Meeting, Tartu, Estonia. Jan 2017. (Selected for oral presentation)</p></li>
</ul>
</section>
<section id="posters" class="level2">
<h2 class="anchored" data-anchor-id="posters">Posters</h2>
<ul>
<li><p>Sou T, Lacroix B, Naik H, Khandelwal A, Coello N. Horseshoe prior as a fast and efficient approach for covariate selection in pharmacometric modelling. PAGE 33 (2025) Abstr 11683 <a href="https://www.page-meeting.org/?abstract=11683">[www.page-meeting.org/?abstract=11683]</a></p></li>
<li><p>Graham G, Sou T. Continuous-time Markov models: Investigation into the use of Stan and msm for fitting disease progression models for EDSS in multiple sclerosis. PAGE 33 (2025) Abstr 11452 <a href="https://www.page-meeting.org/?abstract=11452">[www.page-meeting.org/?abstract=11452]</a></p></li>
<li><p>Coello N, Lacroix B, Faller T, Naik H, Sou T, et al.&nbsp;Exposure-response analysis of minzasolmin in Parkinson’s disease using a lean fit for purpose approach to inform decision making. PAGE 33 (2025) Abstr 11519 <a href="https://www.page-meeting.org/?abstract=11519">[www.page-meeting.org/?abstract=11519]</a></p></li>
<li><p>Sou T, Lorenzo S, Sechaud R, Weber HJ. Population PK/PD modelling to evaluate the effect of siremadlin and disease progression on platelet dynamics in haematological malignancies. PAGE 32 (2024) Abstr 10920 <a href="https://www.page-meeting.org/?abstract=10920">[www.page-meeting.org/?abstract=10920]</a></p></li>
<li><p>Sou T, Meille C, Lorenzo S, Sechaud R. Population PK/PD modelling of platelet dynamics for dose selection in patients with haematological malignancies. PAGE 31 (2023) Abstr 10337 <a href="https://www.page-meeting.org/?abstract=10337">[www.page-meeting.org/?abstract=10337]</a></p></li>
<li><p>Sou T, Hansson E, Bergstrand M, Callewaert F, de Passos Sousa R, Sargentini-Maier ML. Caplacizumab Model-Based Dosing Recommendations In Pediatric Patients With Acquired Thrombotic Thrombocytopenic Purpura. PAGE 29 (2021) Abstr 9653 <a href="https://www.page-meeting.org/?abstract=9653">[www.page-meeting.org/?abstract=9653]</a></p></li>
<li><p>Sou T, Callewaert F, de Passos Sousa R, Sargentini-Maier ML. PKPD modeling and simulations highlight the importance of the intravenous loading dose and daily dosing regimen with caplacizumab for patients with aTTP. International Society on Thrombosis and Haemostasis (ISTH) Virtual Congress, Hosted from Philadelphia, USA. 17-21 Jul 2021.</p></li>
<li><p>Sou T, Liepins E, Hansen J, Grinberga S, Backlund M, Ercan O, et al.&nbsp;Translational PK and PKPD modelling of preclinical in-vitro and in-vivo studies to predict the efficacious intravenous human dose of apramycin. ASM/ECSMID Conference on Drug Development, Boston, USA. 3-6 Sep 2019.</p></li>
<li><p>Sou T, Liepins E, Hansen J, Grinberga S, Backlund M, Ercan O, et al.&nbsp;Translational PK and PKPD modelling of preclinical in-vitro and in-vivo studies to predict the efficacious human dose of apramycin. PAGE 28 (2019) Abstr 8890 <a href="https://www.page-meeting.org/?abstract=8890">[www.page-meeting.org/?abstract=8890]</a></p></li>
<li><p>Gkoufa A, Karaiskos I, Routsi C, Friberg L, Sou T, Lin YW, et al.&nbsp;Pulmonary and systemic pharmacokinetics of colistin methanesulfonate (CMS) and colistin following nebulisation of CMS at a dose of 3 MIU and 5 MIU in ICU patients with ventilator-associated pneumonia. ECCMID, Amsterdam, Netherlands. Apr 2019.</p></li>
<li><p>Sou T, Kukavica-Ibrulj I, Soukarieh F, Halliday N, Levesque RC, Williams P, et al.&nbsp;PK/PD of quorum sensing inhibitors for pulmonary delivery as a novel treatment against Pseudomonas aeruginosa. CRS Annual Meeting, New York, USA. Jul 2018.</p></li>
<li><p>Sou T, Kukavica-Ibrulj I, Soukarieh F, Halliday N, Levesque RC, Williams P, et al.&nbsp;Pharmacokinetic modelling of a new antimicrobial agent for Pseudomonas aeruginosa lung infection. World Meeting on Pharmaceutics, Biopharmaceutics and Pharmaceutical Technology, Granada, Spain. Mar 2018.</p></li>
<li><p>Sou T, Kukavica-Ibrulj I, Soukarieh F, Halliday N, Levesque RC, Williams P, et al.&nbsp;Quorum sensing inhibitors for pulmonary delivery as a novel treatment against Pseudomonas aeruginosa. Northern Pharma Network Meeting, Odense, Denmark. 29-31 Jan 2018. (Best presentation award with travel grant to CRS NY 2018)</p></li>
<li><p>Sou T, Kukavica-Ibrulj I, Soukarieh F, Halliday N, Levesque RC, Williams P, et al.&nbsp;A pharmacokinetic model of a new antimicrobial agent after pulmonary delivery for the treatment of chronic Pseudomonas aeruginosa lung infection. American Association of Pharmaceutical Scientists Annual Meeting, San Diego, USA. 12-15 Nov 2017.</p></li>
<li><p>Soukarieh F, Sou T, Iubatti M, Kukavica-Ibrulj I, Oton EV, Halliday N, Bergström CAS, et al.&nbsp;SENBIOTAR: Sensitizing Pseudomonas aeruginosa biofilms to antibiotics and reducing virulence through novel target inhibition. International Conference on Pseudomonas, Liverpool, UK. 2017.</p></li>
<li><p>Sou T, Kukavica-Ibrulj I, Soukarieh F, Halliday N, Levesque RC, Williams P, et al.&nbsp;Quorum sensing inhibitors for pulmonary delivery as a novel treatment against Pseudomonas aeruginosa. FIP Young Scientist Satellite Conference, Uppsala, Sweden. May 2017.</p></li>
<li><p>Sou T, Kaminskas LM, McIntosh MP, Morton DAV. Investigation of the protective effect of L-leucine on particle formation of hygroscopic excipients during spray-drying. Drug Delivery to the Lungs 23, Edinburgh, UK. Dec 2012.</p></li>
<li><p>Sou T, Nassta T, Kaminskas LM, McIntosh MP, Prankerd R, Orlando L, et al.&nbsp;Particle engineering of a mannitol-based powder formulation for delivery of biomolecules to the lung. Drug Delivery to the Lungs 22, Edinburgh, UK. Dec 2011.</p></li>
<li><p>Sou T, McIntosh MP, Kaminskas LM, Orlando L, Morton DAV. The interaction effect of leucine, glycine and alanine on the performance of a mannitol dry powder formulation. American Association of Pharmaceutical Scientists Annual Meeting, New Orleans, USA. 2010.</p></li>
<li><p>Sou T, McIntosh MP, Kaminskas LM, Orlando L, Morton DAV. An investigation on the interaction effect of amino acids on the performance of a mannitol dry powder formulation using a design of experiment approach. Globalisation of Pharmaceutical Education Conference 2010, North Carolina, USA. 2010.</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>